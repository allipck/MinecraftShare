<html><pre>
===============================================================================
【ソ フ ト名】  UPnPCJ ver 1.33
【登  録  名】  UPnPCJ133
【機能　概要】  UPnP対応ルーターのポート開放ツール
【著作権  者】  マスカット
【対応  ＯＳ】  Windows2000,XP
【ソフト種別】  フリーソフトウェア
【公開　場所】  http://umemasu2018.g1.xrea.com/       (リンクフリー)
【Down Load 】  http://umemasu2018.g1.xrea.com/upnpcj/UPnPCJ133.zip
【転載　条件】  なし。ご自由にどうぞ(まあ、商用は不可で)
===============================================================================

-------------------------------------------------------------------------------
【ソフト紹介】
-------------------------------------------------------------------------------
　　UPnP非対応のネットワークサーバーアプリケーション使用時に必要な
　　ルーターのポート開放作業（ルーターのアドレス変換や、ＩＰの固定作業）
　　なしで、ボタン１つで、手軽にポート開放を行います
　　※ファイアウォールの設定は別途必要です

　　※UPnPCJ.exeで実行テストする場合は一時的に、ＸＰのＦＷ、および、市販ＦＷを
　　※無効にしてテストしてください

-------------------------------------------------------------------------------
【操作方法】
-------------------------------------------------------------------------------
　①WAN_PORT　　　　　ルーターが受けるポート
　②PROT(TCP or UDP)　TCP or UDP
　③LAN_PORT　　　　　サーバーアプリケーションが受けるポート
　④LAN_IP　　　　　　LAN側IPアドレス（自動設定）
　⑤COMMENT　　　　　 コメント（自動設定）

　⑥ルーターのWAN側アドレス取得ボタン
　⑦ショートカット作成するかどうかのチェック
　⑧情報（LAN_IPがプライベートならルーターあり、グローバルならルーターなし）
　⑨ルーター情報取得ボタン　質問用テンプレートや、報告用テンプレート表示
　⑩ポート開放ボタン
　⑪ポート閉鎖ボタン
　⑫ルーターExplorerで開くボタン
　⑬PortMap　UPnPで開放されているポート一覧を表示
　⑭機器指定：通常は空白（利用しません）
　　　　　　：同一サブネット内で二重ルーターの時に外側のルーターのIPを
　　　　　　：指定する事によって開放します
　　　　　　：（テスト機能なので動作するかわかりません）

＜１、①WAN_PORT、②プロトコル、③LAN_PORTの設定＞
　　　ルーターが受けるポート番号を指定します
　　　例えば、shoutcastや、icecast2のポートはデフォルトでTCPの8000ですので
　　　①8000
　　　②TCP
　　　③省略可(通常①と同じ8000を設定します)
　　　
　　　※④、⑤は自動設定ですので変更する必要はありません

＜２、ポート開放＞
　　　⑩ポート開放ボタンを押します
　　　「ポート開放しました」　　　→正常
　　　「ポート開放に失敗しました」→異常
　　　
　　　⑦ショートカット作成にチェックした場合、デスクトップでアイコンができます
　　　次回からはこのアイコンで処理が可能です
　　　※ショートカットから実行した場合、エラー時のみメッセージが表示されます

　　　※開放したポートは通常、一定時間の無通信でタイムアウトし自動的に閉鎖されます
　　　※詳細は、ルーターのUPnP機能のタイムアウト項目を参照してください
　　　※ルーターを再起動した場合も、閉鎖されることがあります
　　　
　　　異常の場合の原因
　　　・ルーターが見つかりません
　　　　→確認１：XPFW,市販FWの無効でも同じ？
　　　　→確認２：UPnP機能が無効になっていませんか？

　　　　⑨ルーター情報取得ボタンの結果を掲示板まで♪

　　　・このソフトとルーターの相性が悪い
　　　　→手動でポートマッピングを変換 or プロバイダ変更 or ルーター買い替え

　　　・ノートンやウイルスバスターで、このソフトの外部アクセスを遮断した
　　　　→セキュリティを一時的に無効にするか、このソフトの外部アクセス許可を行う

　　　・他のソフト（メッセ等）がすでにUPnPで同じポートを確保している
　　　　→他のポートを利用する


＜３、ポート閉鎖＞
　　　ネットワークサーバーアプリケーションを終了する場合、ポートも閉鎖
　　　しておきましょう。
　　　ショートカットのポート閉鎖で簡単に閉鎖できます

-------------------------------------------------------------------------------
【トラブルシューティング】
-------------------------------------------------------------------------------
「はじめに」
　　調子がわるくなったらとりあえず、
　　★一度ルーターを再起動してください

「いままでできてたけど、ポート開放に失敗」
「ポート閉鎖でエラーとなります」
　　ルーターによっては、ポート開放を行ったIPからでないと閉鎖を受け付けない
　　ものがあります。（不用意に他者が閉鎖しない為のセキュリティー機能）
　　（例えば、再起動でPCのローカルIPが変動した場合等）
　　★この場合、一度ルーターを再起動してください
　　
「ルーターが見つからないと表示される」
　　可能性１：ルーターのUPnP機能がOFFになっている
　　　　　　　最近は、初期設定ではUPnP機能が利用できないものがあります
　　　　　　★ルーターにログインして設定するか、あきらめろん

　　可能性２：ＯＳのファイアーウォールに阻止された
　　　　　　★ルーターのＦＷ設定ができないなら、あきらめろん

　　可能性３：未知なUPnPサーバーのルーター
　　　　　　★無難なルーターに買い換えるか、あきらめろん

　　可能性４：IPv6環境
　　　　　　★IPv6はそもそも、ポート開放する必要がないハズ
　　　　　　★ポート開放が必要なものは、基本IPv4なのでIPv6環境では環境違いです

　　可能性５：ルーターが存在しない（壁にLANポートがあり、物理的にルーターがない）
　　　　　　ルーターがないなら、ポート開放は基本できない可能性が高い
　　　　　　もしくは、グローバルIP付与なのでポート開放する必要がない(全開放状態)

「ポート開放テストに失敗する」
　　ポート開放テストは、外部からのアクセスをテストするものです
　　（第三者にテストしてもらうのをUPnPCJがテストサーバーになって外部からテストします）
　　
　　addportmapping(ポート開放)がOK(upnp機能が有効だった)で、テストに失敗するのは、
　　１、二重ルーター（自宅内にルーター機能が２つある）
　　２、二重ルーター（自宅には１つだが、アパート等で家主がルーターを管理している）
　　３、ポート開放ロック(プロバイダから、グローバルアドレスを付与されない plalaや無料wifi等)

　　二重ルーターの場合、ネットに詳しくないなら、あきらめた方がよい
　　（サポートできる人に頼りましょう）

「ポート開放テストに成功したが、ポートスキャンスクリプトで失敗します」
　　ポート開放テストに成功＝ポートスキャンスクリプトを実行し成功しています
　　（開放テストに成功しているのにポートスキャンスクリプトする意味がありません）

　　まあ、テストしたいなら、
　　１、UPnPCJでポート開放する
　　２、実際のサーバーを立ち上げる　←★重要です！！！
　　３、ポートスキャンスクリプトでテストします
　　★UDPのポートスキャンスクリプトは基本できません

　　なお、UPnPCJのポート開放テストは、下記を自動的に行って判定しています
　　１、UPnPCJでポート開放(28800)
　　２、UPnPCJが仮サーバーとなり、28800ポートを待ち受けます
　　３、外部(kuro様や390様)からテストを自動実行します
　　★UPnPCJの仮サーバーは、UDPもテストできるようになっています

　　
　　TCPの場合、スクリプト側で接続判定が可能ですが、
　　UDPの場合、スクリプト側で判定ができず、受信側(ゲームサーバー側)で判定する必要があります
　　よってUDPは、通常のスクリプトでは判定ができないのです


「その他、再度確認」
　　UDP、TCPのどちらが必要かを確認してください
　　

-------------------------------------------------------------------------------
【アンインストール】
-------------------------------------------------------------------------------
　C:\Program Files\UPnPCJのフォルダを削除してください。
　ショートカットを削除するときに「追加と削除」とかでますけど、
　気にせずショートカットも削除してください。
　（レジストリは使用しておりません）

-------------------------------------------------------------------------------
【起動時のパラメータ】
-------------------------------------------------------------------------------
　ショートカットや、バッチ等　からの起動パラメータ
　①WAN_PORT　　　　　ルーターが受けるポート
　②PROT(TCP or UDP)　TCP or UDP
　③LAN_PORT　　　　　サーバーアプリケーションが受けるポート（省略時①）
　④LAN_IP　　　　　　LAN側IPアドレス or 自動1 or 自動2 or 自動3
　⑤COMMENT　　　　　 コメント（自動設定）

＜１、開放時＞
　UPnPCJ.exe /open  ① ② ③ ④ ⑤
　例　UPnPCJ.exe /open 8000 TCP 8000 自動2
　例　UPnPCJ.exe /open 8000 TCP 8000 192.168.1.2
　例　UPnPCJ.exe /open 8000 TCP 8000 umemasu_pc
　例　UPnPCJ.exe /open 8000 TCP
　例　UPnPCJ.exe /open 8000 UDP

　③～⑤は省略可
　④には、コンピュータ名または、ローカルIPを設定します

＜２、閉鎖時＞
　UPnPCJ.exe /close ① ②
　例　UPnPCJ.exe /close 8000 TCP
　例　UPnPCJ.exe /close 8000 UDP

-------------------------------------------------------------------------------
【設定ウィザード／アプリケーション連携（自動実行定義）】
-------------------------------------------------------------------------------
# 【概要】
#  ・対象ポート番号を自動的に取得し、ポート開放後、サーバーソフトを実行します
#  ・サーバーソフトが終了したら、ポートを自動的に閉鎖します
#
# 【利用方法】
#  ・UPnPCJ.exeの設定ウィザードボタンを押します
#  ※.iniファイルが作成されていない場合はあらかじめサーバーソフトを
#    起動して、.iniを作成しておく必要があります
#

※詳細は、UPnPCJ.def

-------------------------------------------------------------------------------
【開発履歴】
-------------------------------------------------------------------------------
  2005/09/04 Ver1.00
    ・コンパイル完
  2005/09/05 Ver1.01
    ・ショートカット作成機能追加
  2005/09/06 Ver1.02
    ・UDP閉鎖不具合修正
    ・リリース
  2005/09/19 Ver1.03
    ・RT WAN側アドレス取得ボタン追加
  2005/09/21 Ver1.04
    ・プライベートアドレス判定バグ修正
    ・ショートカット作成時、第４パラメータにコンピュータ名を設定
  2005/09/22 Ver1.05
    ・⑨ルーター情報取得ボタン追加
  2005/09/23 Ver1.06
    ・起動時にDNS参照しFWのチェック
    ・ルーター情報で、IPがプライベートの場合全桁表示
  2005/09/28 Ver1.07
    ・レジストリ値から、DHCPサーバーアドレスを取得し表示
  2005/10/07 Ver1.08
    ・DCHP→DefaultGateway取得に変更
  2005/10/17 Ver1.09
    ・Timer処理、Sleep処理の変更
  2005/12/21 Ver1.10
    ・設定ウィザード追加
  2005/12/28 Ver1.11
    ・PortMappingEntry表示(For Win2000)
    ・Postする内容を変更(MSN互換)
  2006/01/10 Ver1.12
    ・ポートの複数指定(例：8000-8001,9000)
    ・動作モード(MSN風 or 通常 or 両方)
  2006/01/12 Ver1.13
    ・xml処理の変更
    ・defのオンラインアップデート機能追加
  2006/01/14 Ver1.14
    ・外部アドレス取得処理の修正
  2006/01/24 Ver1.15
    ・複数NIC存在時の対策
  2006/01/27 Ver1.16
    ・GateWay取得方法変更
  2006/03/21 Ver1.17
    ・ポート開放テスト（外部より接続テスト）
  2006/10/25 Ver1.18
    ・mode2,3バグ修正
  2006/12/04 Ver1.19
    ・ログオフ時の終了処理追加
    ・TCP/UDPの選択をラジオボタン化、tootip表示追加
    ・U_DDNS呼び出しボタン追加
    ・設定ウィザードのメッセージ修正
    ・LANIP取得は、自動2をデフォルト
    ・共通モジュールの更新
  2006/12/08 Ver1.20
    ・ログオフ時の終了処理修正（proxy経由時はモード３で切断処理試行）
    ・キーボードで指定できるよう、ショートカットキーを設定
    ・ショートカット作成オプション、前回のポート番号を記憶
  2007/02/21 Ver1.21
    ・シャットダウン／ログオフ時に異常終了するバグ修正
  2007/02/23 Ver1.22
    ・シャットダウン／ログオフ時に異常終了するバグ修正2
  2009/01/27 Ver1.23
    ・PPP,IPが固定になっていたバグを修正（IIJ様、情報提供ありがとうございます）
  2009/12/09 Ver1.24
    ・PPP,IP両方でチェックするように変更
    ・UDPの外部接続テストチェック機能を追加
　2010/01/05 Ver 1.25
　　・無線ブリッジ時の複数機器認識に対応（⑮より）。定義の修正
　2010/02/14 Ver 1.26
　　・warrock用設定の削除(ポート開放不要になった為)
　　・「グローバルIPアドレス:ポート」をクリップボードへコピーボタン追加
　2010/06/08 Ver 1.27
　　・ＨＰ移転(iswebのsock規制の為･･･)、ポート開放テスト修正
　2010/06/09 Ver 1.28
　　・ＨＰ戻すorz
　2010/09/11 Ver 1.29
　　・楽天がぁ乙った・・・・・・・・・・・
　2012/04/18 Ver 1.30
　　・マルチキャスト不具合修正（今まで機器が反応しないものも反応するかもしれません）
　　・CloseAll(すべてのポート閉鎖)
　　・開放・閉鎖時に画像表示
　2013/04/09 Ver 1.31
　　・cgiサーバーの変更
　2014/03/15 Ver 1.32
　　・cgiサーバーの変更(cgiサーバーは動的に取得するように変更)
　2018/10/10 Ver 1.33
　　・yahoo終了にともなう修正(cgiリストをyahoo→xrea)
　　※ポート開放テストを利用しないなら更新する必要はありません
</html>
